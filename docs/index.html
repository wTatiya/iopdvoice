<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏Å‚Äì‡πÉ‡∏ô</title>
    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        color-scheme: light;
        font-family: "Sarabun", "Inter", "Segoe UI", sans-serif;
        line-height: 1.6;
        background: #eef2ff;
        color: #0f172a;
      }

      body {
        margin: 0;
        min-height: 100vh;
        background: radial-gradient(circle at 0% -20%, rgba(191, 219, 254, 0.75), rgba(238, 242, 255, 0.95) 45%, #f8fafc 100%);
        color: inherit;
      }

      .dashboard {
        max-width: 1280px;
        margin: 0 auto;
        padding: 2.5rem clamp(1.5rem, 4vw, 3rem) 4rem;
      }

      .dashboard-header {
        display: grid;
        gap: 1.75rem;
        background: rgba(255, 255, 255, 0.78);
        border: 1px solid rgba(148, 163, 184, 0.2);
        border-radius: 32px;
        padding: 2.25rem clamp(1.5rem, 3vw, 2.75rem);
        box-shadow: 0 32px 60px rgba(15, 23, 42, 0.12);
        backdrop-filter: blur(22px);
      }

      .top-bar {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        justify-content: space-between;
        gap: 1.5rem;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 1.25rem;
      }

      .brand-icon {
        width: 60px;
        height: 60px;
        border-radius: 20px;
        background: linear-gradient(135deg, #6366f1, #22d3ee);
        display: grid;
        place-items: center;
        color: #ffffff;
        font-weight: 700;
        font-size: 1.1rem;
        letter-spacing: 0.04em;
      }

      .brand-copy {
        display: grid;
        gap: 0.35rem;
      }

      .brand-copy span {
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        color: #4f46e5;
        font-weight: 600;
      }

      .brand-copy h1 {
        margin: 0;
        font-size: clamp(2rem, 3vw, 3rem);
        color: #0f172a;
      }

      .search {
        position: relative;
        max-width: 420px;
        width: 100%;
      }

      .search input {
        width: 100%;
        padding: 0.85rem 1rem 0.85rem 2.75rem;
        border-radius: 18px;
        border: 1px solid rgba(148, 163, 184, 0.2);
        background: rgba(248, 250, 252, 0.9);
        box-shadow: inset 0 1px 2px rgba(148, 163, 184, 0.1);
        font-size: 0.95rem;
      }

      .search::before {
        content: "üîç";
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        font-size: 1rem;
        opacity: 0.6;
      }

      .dashboard-header p {
        margin: 0;
        color: #475569;
        max-width: 76ch;
      }

      .main-grid {
        margin-top: 2.75rem;
        display: grid;
        gap: 1.75rem;
        grid-template-columns: repeat(12, minmax(0, 1fr));
      }

      .card {
        background: rgba(255, 255, 255, 0.85);
        border-radius: 28px;
        border: 1px solid rgba(148, 163, 184, 0.22);
        padding: 2.1rem clamp(1.25rem, 3vw, 2.25rem);
        box-shadow: 0 32px 60px rgba(15, 23, 42, 0.1);
        backdrop-filter: blur(18px);
      }

      .span-12 {
        grid-column: span 12;
      }

      .span-7 {
        grid-column: span 7;
      }

      .span-5 {
        grid-column: span 5;
      }

      h2 {
        margin: 0 0 0.5rem;
        font-size: clamp(1.65rem, 2.2vw, 2.4rem);
        color: #0f172a;
        letter-spacing: -0.01em;
      }

      h3 {
        margin: 1.75rem 0 0.75rem;
        font-size: clamp(1.2rem, 1.9vw, 1.75rem);
        color: #1e293b;
      }

      .metric-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 1.25rem;
        margin-top: 1.5rem;
      }

      .metric-card,
      .chart-card,
      .list-card,
      .insight-card {
        background: rgba(248, 250, 252, 0.9);
        border-radius: 20px;
        padding: 1.5rem;
        border: 1px solid rgba(191, 219, 254, 0.6);
        box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.7);
      }

      .metric-card {
        position: relative;
        overflow: hidden;
      }

      .metric-card::after {
        content: "";
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at 80% 20%, rgba(99, 102, 241, 0.15), transparent 60%);
        pointer-events: none;
      }

      .metric-card h4 {
        margin: 0;
        font-size: 0.85rem;
        letter-spacing: 0.16em;
        text-transform: uppercase;
        color: #475569;
        font-weight: 600;
      }

      .metric-card p {
        margin: 1rem 0 0;
        font-size: clamp(2rem, 4vw, 2.85rem);
        font-weight: 700;
        color: #0f172a;
      }

      .indicator-group {
        margin-top: 0.75rem;
      }

      .indicator-group + .indicator-group {
        margin-top: 0.65rem;
      }

      .metric-indicator {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        font-weight: 600;
        font-size: 1rem;
      }

      .metric-indicator--up {
        color: #16a34a;
      }

      .metric-indicator--down {
        color: #dc2626;
      }

      .metric-indicator--flat {
        color: #1e293b;
      }

      .indicator-symbol {
        font-size: 1rem;
        line-height: 1;
      }

      .indicator-caption {
        margin-top: 0.25rem;
        font-size: 0.75rem;
        color: #475569;
        font-weight: 600;
      }

      .indicator-caption--secondary {
        color: #64748b;
        font-weight: 500;
      }

      .indicator-change {
        font-variant-numeric: tabular-nums;
      }

      .chart-container {
        width: 100%;
        min-height: 360px;
      }

      .split-grid {
        display: grid;
        gap: 1.25rem;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      }

      .split-grid--service-dynamics {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }

      .split-grid--service-dynamics .chart-card {
        grid-column: 1 / -1;
      }

      @media (max-width: 900px) {
        .split-grid--service-dynamics {
          grid-template-columns: minmax(0, 1fr);
        }
      }

      .list-card ul {
        list-style: none;
        margin: 0;
        padding: 0;
        display: grid;
        gap: 0.85rem;
      }

      .list-card li {
        display: grid;
        gap: 0.4rem;
      }

      .list-card strong {
        color: #1e293b;
      }

      .list-card .list-detail-accent {
        font-style: italic;
        color: #475569;
      }

      .tag {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        padding: 0.25rem 0.75rem;
        border-radius: 999px;
        font-size: 0.78rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        background: rgba(99, 102, 241, 0.14);
        color: #312e81;
        font-weight: 600;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 1.25rem;
        font-size: 0.95rem;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 18px;
        overflow: hidden;
      }

      .table-layout {
        display: grid;
        gap: 1.5rem;
        margin-top: 1.5rem;
      }

      .table-layout--monthly {
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        align-items: start;
      }

      .table-layout h3 {
        margin: 0;
        color: #1e293b;
      }

      .table-layout .table-scroll {
        margin-top: 1rem;
      }

      th,
      td {
        padding: 0.75rem 1rem;
        text-align: left;
      }

      th {
        background: #e0e7ff;
        color: #1f2937;
        font-weight: 600;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        font-size: 0.78rem;
      }

      tbody tr:nth-child(even) {
        background: rgba(226, 232, 240, 0.4);
      }

      tbody tr:hover {
        background: rgba(191, 219, 254, 0.45);
      }

      .tab-strip {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1.5rem;
      }

      .tab-strip button {
        border: 1px solid rgba(99, 102, 241, 0.4);
        background: rgba(248, 250, 252, 0.85);
        color: #312e81;
        padding: 0.55rem 1.35rem;
        border-radius: 999px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-size: 0.95rem;
        font-weight: 600;
      }

      .tab-strip button.active {
        background: #6366f1;
        color: #ffffff;
        border-color: #4f46e5;
        box-shadow: 0 12px 24px rgba(79, 70, 229, 0.25);
      }

      .tab-strip button:hover {
        background: rgba(99, 102, 241, 0.12);
      }

      ul.insights {
        list-style: none;
        padding-left: 1.2rem;
        display: grid;
        gap: 0.75rem;
      }

      ul.insights li::before {
        content: "‚ñπ";
        margin-right: 0.5rem;
        color: #4338ca;
      }

      .control-group {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: 0.85rem;
        margin-bottom: 1.25rem;
      }

      .control-group label {
        font-size: 0.95rem;
        color: #1f2937;
        font-weight: 600;
      }

      .control-group select {
        background: rgba(248, 250, 252, 0.9);
        color: #312e81;
        border: 1px solid rgba(129, 140, 248, 0.6);
        border-radius: 999px;
        padding: 0.45rem 1.35rem;
        font-size: 0.95rem;
        font-weight: 600;
        box-shadow: 0 10px 18px rgba(129, 140, 248, 0.15);
      }

      .inline-stats {
        display: flex;
        flex-wrap: wrap;
        gap: 1.25rem;
        margin-top: 1.25rem;
        color: #1f2937;
        font-size: 0.95rem;
      }

      .inline-stats span {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
      }

      .note {
        font-size: 0.85rem;
        color: #64748b;
        margin-top: 1rem;
      }

      footer {
        text-align: center;
        font-size: 0.85rem;
        color: #475569;
        padding: 2.75rem 1rem 0;
      }

      .table-scroll {
        overflow-x: auto;
      }

      .highlight-value {
        font-weight: 700;
        color: #1d4ed8;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        padding: 0.25rem 0.85rem;
        border-radius: 999px;
        background: rgba(14, 165, 233, 0.18);
        color: #0f172a;
        font-size: 0.82rem;
        font-weight: 600;
      }

      .legend {
        display: flex;
        flex-wrap: wrap;
        gap: 0.65rem;
        margin-top: 0.9rem;
      }

      .legend span {
        display: inline-flex;
        align-items: center;
        gap: 0.4rem;
        font-size: 0.85rem;
        color: #1f2937;
        font-weight: 500;
      }

      .legend span::before {
        content: "";
        width: 12px;
        height: 12px;
        border-radius: 3px;
        display: inline-block;
      }

      @media (max-width: 1080px) {
        .span-7,
        .span-5 {
          grid-column: span 12;
        }

        .header-actions {
          justify-content: space-between;
        }

        .search {
          max-width: unset;
        }
      }

      @media (max-width: 720px) {
        .dashboard {
          padding: 1.75rem 1.25rem 3rem;
        }

        .dashboard-header {
          padding: 1.75rem 1.4rem;
        }

        .card {
          padding: 1.6rem 1.35rem;
        }

        table {
          font-size: 0.85rem;
        }

        th,
        td {
          padding: 0.65rem 0.75rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="dashboard">
      <header class="dashboard-header">
        <div class="top-bar">
          <div class="brand">
            <div class="brand-icon" aria-hidden="true">IO</div>
            <div class="brand-copy">
              <span>IOPD Voice</span>
              <h1>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h1>
            </div>
          </div>
        </div>
        <div class="search">
          <input type="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏á‡∏≤‡∏ô ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô" aria-label="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î" />
        </div>
        <p>
          ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏° 2024 ‡∏ñ‡∏∂‡∏á‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏° 2025
        </p>
      </header>
      <main class="main-grid">
        <section id="at-a-glance" class="card span-12">
          <h2>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</h2>
          <div class="metric-grid" id="metrics"></div>
          <h3>10 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</h3>
          <p id="coverage"></p>
          <div class="table-layout table-layout--monthly">
            <div>
              <h3>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h3>
              <div class="table-scroll">
                <table id="monthly-top-table" aria-label="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î">
                  <thead>
                    <tr>
                      <th scope="col">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                      <th scope="col">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                      <th scope="col">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
            <div>
              <h3>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î</h3>
              <div class="table-scroll">
                <table id="monthly-bottom-table" aria-label="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î">
                  <thead>
                    <tr>
                      <th scope="col">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                      <th scope="col">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                      <th scope="col">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </section>

        <section id="rankings" class="card span-12">
          <h2>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</h2>
          <p>
            ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÇ‡∏Ñ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (average) ‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏ö‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (œÉ) ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô ‡∏™‡∏•‡∏±‡∏ö‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏î‡∏î‡πÄ‡∏î‡πà‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏µ
          </p>
          <div class="tab-strip" role="tablist" aria-label="‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö">
            <button type="button" data-key="overall" class="active">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</button>
            <button type="button" data-key="2067">‡∏õ‡∏µ 2067</button>
            <button type="button" data-key="2068">‡∏õ‡∏µ 2068</button>
          </div>
          <div class="metric-grid" style="margin-top: 1.5rem">
            <div>
              <h3>10 ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</h3>
              <div class="table-scroll">
                <table id="top-table" aria-live="polite">
                  <thead>
                    <tr>
                      <th scope="col">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                      <th scope="col">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                      <th scope="col">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</th>
                      <th scope="col">‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤ œÉ</th>
                      <th scope="col">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
            <div>
              <h3>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î</h3>
              <div class="table-scroll">
                <table id="bottom-table" aria-live="polite">
                  <thead>
                    <tr>
                      <th scope="col">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                      <th scope="col">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                      <th scope="col">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</th>
                      <th scope="col">‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡πà‡∏≤ œÉ</th>
                      <th scope="col">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>
        </section>

        <section id="service-dynamics" class="card span-7">
          <h2>‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h2>
          <p>
            ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô ‡πÅ‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠‡πÇ‡∏î‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ô‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö
          </p>
          <div class="split-grid split-grid--service-dynamics">
            <div class="chart-card">
              <h3>‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô (œÉ ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</h3>
              <div class="chart-container" id="volatility-chart" role="img" aria-label="‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"></div>
              <div class="inline-stats" id="volatility-summary"></div>
            </div>
            <div class="list-card">
              <h3>‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á</h3>
              <p class="note">
                ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÅ‡∏ö‡∏ö‡∏ñ‡πà‡∏ß‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ‚â•4.50
              </p>
              <ul id="high-performance-list"></ul>
            </div>
            <div class="list-card">
              <h3>‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h3>
              <p class="note">
                ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡∏•‡∏≥‡∏î‡∏±‡∏ö
              </p>
              <ul id="critical-gaps-list"></ul>
            </div>
          </div>
        </section>

        <section id="operations" class="card span-5">
          <h2>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏î‡πâ‡∏≤‡∏ô‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö</h2>
          <div class="split-grid">
            <div class="chart-card">
              <h3>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à</h3>
              <div class="chart-container" id="wait-correlation-chart" role="img" aria-label="‡∏Å‡∏£‡∏≤‡∏ü‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏ß‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à"></div>
              <p class="note" id="wait-correlation-note"></p>
            </div>
            <div class="insight-card">
              <h3>‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡πà‡∏≤‡∏á</h3>
              <ul class="insights" id="benchmarking-list"></ul>
              <p class="note">
                ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
              </p>
            </div>
          </div>
        </section>

        <section id="trend-analysis" class="card span-12">
          <h2>‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏£‡∏≤‡∏¢‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</h2>
          <p>
            ‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô ‡∏ß‡∏≤‡∏á‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÅ‡∏ö‡∏ö‡∏ñ‡πà‡∏ß‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
          </p>
          <div class="control-group">
            <label for="trend-select">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</label>
            <select id="trend-select" aria-label="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô"></select>
            <span class="pill" id="trend-months"></span>
          </div>
          <div class="chart-card" style="padding: 1.25rem">
            <div class="chart-container" id="trend-chart" role="img" aria-label="‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô"></div>
            <div class="inline-stats" id="trend-stats"></div>
          </div>
        </section>

        <section id="sentiment-insights" class="card span-12">
          <h2>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h2>
          <p>
           ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏ä‡∏¥‡∏á‡∏ã‡πâ‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
          </p>
          <div class="chart-card">
            <h3>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏ß‡∏•‡∏≤</h3>
            <div class="chart-container" id="theme-chart" role="img" aria-label="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡πÄ‡∏ä‡∏¥‡∏á‡∏ã‡πâ‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô"></div>
            <div class="legend" id="theme-legend"></div>
          </div>
          <div class="split-grid">
            <div class="insight-card">
              <h3>‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏£‡∏∞‡∏ö‡∏ö</h3>
              <ul class="insights" id="systemic-weaknesses"></ul>
              <p class="note" id="sentiment-summary"></p>
            </div>
            <div class="insight-card">
              <h3>‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h3>
              <table>
                <thead>
                  <tr>
                    <th scope="col">‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</th>
                    <th scope="col">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á</th>
                    <th scope="col">‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô</th>
                  </tr>
                </thead>
                <tbody id="time-table"></tbody>
              </table>
              <table style="margin-top: 1rem">
                <thead>
                  <tr>
                    <th scope="col">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏Å‡∏£</th>
                    <th scope="col">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏û‡∏π‡∏î‡∏ñ‡∏∂‡∏á</th>
                  </tr>
                </thead>
                <tbody id="demographic-mentions"></tbody>
              </table>
            </div>
          </div>
        </section>

        <section id="predictive-risk" class="card span-12">
          <h2>‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå</h2>
          <p>
            ‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏•‡∏≠‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡πÉ‡∏ä‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏¢‡πâ‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏•‡∏î‡∏•‡∏á‡πÉ‡∏ô‡∏£‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏î‡∏•‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 0.05 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
          </p>
          <div class="table-scroll">
            <table id="risk-table">
              <thead>
                <tr>
                  <th scope="col">‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                  <th scope="col">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏•‡∏î‡∏•‡∏á</th>
                  <th scope="col">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏û‡∏ö</th>
                  <th scope="col">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </section>

        <section id="equity" class="card span-12">
          <h2>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h2>
          <p>
            ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏Ç‡∏≠‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à ‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏î‡∏ñ‡∏π‡∏Å‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡∏õ‡∏•‡∏≤‡∏¢‡πÄ‡∏õ‡∏¥‡∏î
          </p>
          <div class="split-grid">
            <div class="table-scroll">
              <table id="service-group-table">
                <thead>
                  <tr>
                    <th scope="col">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</th>
                    <th scope="col">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢</th>
                    <th scope="col">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</th>
                    <th scope="col">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
            <div class="table-scroll">
              <table id="demographic-table">
                <thead>
                  <tr>
                    <th scope="col">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á</th>
                    <th scope="col">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô</th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </section>

        <section id="methodology" class="card span-12">
          <h2>‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏ß‡∏¥‡∏ò‡∏µ</h2>
          <p>
            ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÅ‡∏¢‡∏Å‡∏à‡∏≤‡∏Å‡πÅ‡∏ú‡πà‡∏ô‡∏á‡∏≤‡∏ô <code>Total Table</code> ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡πÅ‡∏ö‡∏ö‡∏ñ‡πà‡∏ß‡∏á‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÉ‡∏ä‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡πá‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏û‡∏à‡∏ô‡∏≤‡∏ô‡∏∏‡∏Å‡∏£‡∏°‡∏Ñ‡∏≥‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ã‡πâ‡∏≥ ‡πÜ (‡πÄ‡∏ß‡∏•‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏≠ ‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£ ‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å ‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏≠‡∏≤‡πÉ‡∏à‡πÉ‡∏™‡πà) ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡πÅ‡∏ö‡∏ö‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏•‡∏≠‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏™‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô
          </p>
        </section>
      </main>
      <footer>
        ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å <code>data/</code> ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏ú‡πà‡∏≤‡∏ô GitHub Pages
      </footer>
    </div>

    <script src="https://cdn.plot.ly/plotly-2.35.0.min.js"></script>
    <script>
      const monthNames = [
        '‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°',
        '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå',
        '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°',
        '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô',
        '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°',
        '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
        '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°',
        '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°',
        '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô',
        '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°',
        '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô',
        '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'
      ];

      const thaiListFormatter = new Intl.ListFormat('th', {
        style: 'long',
        type: 'conjunction'
      });

      function formatThaiYearList(years) {
        const beYears = years.map((year) => `‡∏õ‡∏µ ${year + 543}`);
        return thaiListFormatter.format(beYears);
      }

      const themeLabels = {
        wait_time: '‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢',
        attitude: '‡∏ó‡∏±‡∏®‡∏ô‡∏Ñ‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£',
        communication: '‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥',
        process: '‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤',
        facilities: '‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å',
        staffing: '‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£'
      };

      const themePalette = ['#38bdf8', '#22d3ee', '#a855f7', '#f97316', '#facc15', '#14b8a6'];

      const timeLabels = {
        morning: '‡πÄ‡∏ä‡πâ‡∏≤',
        afternoon: '‡∏ö‡πà‡∏≤‡∏¢',
        evening: '‡πÄ‡∏¢‡πá‡∏ô',
        night: '‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô'
      };

      const demographicLabels = {
        elderly: '‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏',
        children: '‡πÄ‡∏î‡πá‡∏Å',
        pregnancy: '‡∏™‡∏ï‡∏£‡∏µ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡∏£‡∏£‡∏†‡πå',
        caregiver: '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•',
        disability: '‡∏ú‡∏π‡πâ‡∏û‡∏¥‡∏Å‡∏≤‡∏£',
        foreign: '‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ï‡πà‡∏≤‡∏á‡∏ä‡∏≤‡∏ï‡∏¥'
      };

      function formatNumber(value, options = {}) {
        return new Intl.NumberFormat('th-TH', options).format(value);
      }

      function formatScore(score) {
        const numeric = Number(score);
        return Number.isFinite(numeric) ? numeric.toFixed(2) : '‚Äî';
      }

      function formatPercent(value) {
        const numeric = Number(value);
        return Number.isFinite(numeric) ? `${(numeric * 100).toFixed(2)}%` : '‚Äî';
      }

      function formatSigma(value) {
        const numeric = Number(value);
        if (!Number.isFinite(numeric)) {
          return '‚Äî';
        }
        const rounded = numeric.toFixed(2);
        const prefix = numeric > 0 ? '+' : numeric < 0 ? '' : '¬±';
        if (prefix === '¬±') {
          return `${rounded}œÉ`;
        }
        return `${prefix}${rounded}œÉ`;
      }

      function formatPeriod(period) {
        const [year, month] = period.split('-').map(Number);
        return `${monthNames[month - 1]} ${year}`;
      }

      function renderIndicator(indicator) {
        if (!indicator) {
          return '';
        }
        const comparisons = [
          {
            direction: indicator.direction,
            symbol: indicator.symbol,
            changeText: indicator.changeText,
            contextText: indicator.contextText,
            ariaLabel: indicator.ariaLabel,
            captionClass: 'indicator-caption'
          }
        ];

        if (indicator.secondaryComparison) {
          comparisons.push({
            direction: indicator.secondaryComparison.direction,
            symbol: indicator.secondaryComparison.symbol,
            changeText: indicator.secondaryComparison.changeText,
            contextText: indicator.secondaryComparison.contextText,
            ariaLabel: indicator.secondaryComparison.ariaLabel,
            captionClass: 'indicator-caption indicator-caption--secondary'
          });
        } else if (indicator.secondaryContextText) {
          comparisons.push({
            contextText: indicator.secondaryContextText,
            captionClass: 'indicator-caption indicator-caption--secondary',
            showIndicator: false
          });
        }

        return comparisons
          .map((comparison) => {
            const indicatorMarkup =
              comparison.showIndicator === false
                ? ''
                : `<div class="metric-indicator metric-indicator--${comparison.direction}" aria-label="${comparison.ariaLabel}">
                    <span class="indicator-symbol" aria-hidden="true">${comparison.symbol}</span>
                    <span class="indicator-change">${comparison.changeText}</span>
                  </div>`;
            return `
              <div class="indicator-group">
                ${indicatorMarkup}
                <div class="${comparison.captionClass}">${comparison.contextText}</div>
              </div>
            `;
          })
          .join('');
      }

      function buildYearlyRecommendationIndicator(metadata, gregorianYear) {
        const mapping = metadata.recommendation_percentage_by_year || {};
        const current = mapping[gregorianYear];
        if (current == null) {
          return null;
        }
        const previousYear = gregorianYear - 1;
        const previous = mapping[previousYear];
        const currentBE = gregorianYear + 543;
        const previousYears = Object.keys(mapping)
          .map(Number)
          .filter((year) => year < gregorianYear && mapping[year] != null)
          .sort((a, b) => a - b);
        if (previous == null && previousYears.length === 0) {
          return {
            direction: 'flat',
            symbol: '‚óÜ',
            changeText: '‚Äî',
            contextText: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á',
            ariaLabel: `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏õ‡∏µ ${currentBE}`
          };
        }

        const threshold = 0.0005;
        const createComparison = (delta, contextText, labels) => {
          const magnitude = Math.abs(delta);
          if (magnitude <= threshold) {
            return {
              direction: 'flat',
              symbol: '‚óÜ',
              changeText: '0.00%',
              contextText,
              ariaLabel: labels.equal
            };
          }
          const direction = delta < 0 ? 'down' : 'up';
          const symbol = direction === 'down' ? '‚ñº' : '‚ñ≤';
          const action = direction === 'down' ? '‡∏•‡∏î‡∏•‡∏á' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô';
          return {
            direction,
            symbol,
            changeText: `${delta < 0 ? '-' : ''}${(magnitude * 100).toFixed(2)}%`,
            contextText,
            ariaLabel: labels.difference(action, magnitude)
          };
        };

        let primaryComparison;
        if (previous == null) {
          primaryComparison = {
            direction: 'flat',
            symbol: '‚óÜ',
            changeText: '‚Äî',
            contextText: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏µ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á',
            ariaLabel: `‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏õ‡∏µ ${currentBE}`
          };
        } else {
          const delta = current - previous;
          const previousBE = previousYear + 543;
          primaryComparison = createComparison(delta, '‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß', {
            equal: `‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏µ ${currentBE} ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏õ‡∏µ ${previousBE}`,
            difference: (action, magnitude) =>
              `‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏µ ${currentBE} ${action} ${(magnitude * 100).toFixed(2)} ‡∏à‡∏∏‡∏î‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏õ‡∏µ ${previousBE}`
          });
        }

        let secondaryComparison = null;
        if (previousYears.length > 0) {
          const sum = previousYears.reduce((acc, year) => acc + mapping[year], 0);
          const average = sum / previousYears.length;
          const delta = current - average;
          const averagedYearsLabel =
            previousYears.length === 1
              ? `‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢${formatThaiYearList(previousYears)}`
              : `‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á${formatThaiYearList(previousYears)}`;
          secondaryComparison = createComparison(delta, '‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤', {
            equal: `‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏µ ${currentBE} ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö${averagedYearsLabel}`,
            difference: (action, magnitude) =>
              `‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏õ‡∏µ ${currentBE} ${action} ${(magnitude * 100).toFixed(2)} ‡∏à‡∏∏‡∏î‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö${averagedYearsLabel}`
          });
        }

        return {
          ...primaryComparison,
          secondaryComparison
        };
      }

      function renderMetrics(metadata) {
        const metrics = document.getElementById('metrics');
        metrics.innerHTML = '';
        const currentYear = 2025;
        const currentRecommendation =
          metadata.recommendation_percentage_by_year &&
          metadata.recommendation_percentage_by_year[currentYear];
        const indicator = buildYearlyRecommendationIndicator(metadata, currentYear);
        const beYear = currentYear + 543;
        const cards = [
          {
            label: '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏£‡∏ß‡∏°',
            value: formatScore(metadata.overall_average_score)
          },
          {
            label: '‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ç‡∏≤‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•',
            value:
              metadata.overall_recommendation_percentage != null
                ? formatPercent(metadata.overall_recommendation_percentage)
                : '‚Äî'
          },
          {
            label: `‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ç‡∏≤‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å ‡∏õ‡∏µ ${beYear}`,
            value:
              currentRecommendation != null ? formatPercent(currentRecommendation) : '‚Äî',
            indicator
          },
          {
            label: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à',
            value: formatNumber(metadata.total_reported_surveys, { maximumFractionDigits: 0 })
          }
        ];
        for (const card of cards) {
          const div = document.createElement('div');
          div.className = 'metric-card';
          div.innerHTML = `<h4>${card.label}</h4><p>${card.value}</p>${renderIndicator(card.indicator)}`;
          metrics.appendChild(div);
        }

        const coverage = document.getElementById('coverage');
        const first = metadata.periods[0];
        const last = metadata.periods[metadata.periods.length - 1];
        const describe = (period) => {
          const [year, month] = period.split('-').map(Number);
          return `${monthNames[month - 1]} ${year}`;
        };
        coverage.textContent = `‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà ${describe(first)} ‡∏ñ‡∏∂‡∏á ${describe(last)} (‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á ${metadata.periods.length} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)`;
      }

      function renderMonthlyTable(summary) {
        const topBody = document.querySelector('#monthly-top-table tbody');
        const bottomBody = document.querySelector('#monthly-bottom-table tbody');
        topBody.innerHTML = '';
        bottomBody.innerHTML = '';
        const periods = summary.metadata.periods;
        for (const period of periods) {
          const view = summary.months[period];
          if (!view) continue;
          const top = view.top10[0];
          const bottom = view.bottom10[0];
          const [year, month] = period.split('-').map(Number);
          const monthLabel = `${monthNames[month - 1]} ${year}`;

          const topRow = document.createElement('tr');
          topRow.innerHTML = `
            <td data-label="‡πÄ‡∏î‡∏∑‡∏≠‡∏ô">${monthLabel}</td>
            <td data-label="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î">${top ? top.department : '‚Äî'}</td>
            <td data-label="‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô">${top ? formatScore(top.average_score) : '‚Äî'}</td>
          `;
          topBody.appendChild(topRow);

          const bottomRow = document.createElement('tr');
          bottomRow.innerHTML = `
            <td data-label="‡πÄ‡∏î‡∏∑‡∏≠‡∏ô">${monthLabel}</td>
            <td data-label="‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ï‡πà‡∏≥‡∏™‡∏∏‡∏î">${bottom ? bottom.department : '‚Äî'}</td>
            <td data-label="‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô">${bottom ? formatScore(bottom.average_score) : '‚Äî'}</td>
          `;
          bottomBody.appendChild(bottomRow);
        }
      }

      function renderRanking(viewKey, summary) {
        const ranking = viewKey === 'overall' ? summary.overall : summary.years[viewKey];
        const topBody = document.querySelector('#top-table tbody');
        const bottomBody = document.querySelector('#bottom-table tbody');
        topBody.innerHTML = '';
        bottomBody.innerHTML = '';

        ranking.top10.forEach((row, index) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${index + 1}</td>
            <td>${row.department}</td>
            <td>${formatScore(row.average_score)}</td>
            <td>${formatSigma(row.sigma_diff)}</td>
            <td>${row.survey_total ? formatNumber(row.survey_total, { maximumFractionDigits: 0 }) : '‚Äî'}</td>
          `;
          topBody.appendChild(tr);
        });

        ranking.bottom10.forEach((row, index) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${index + 1}</td>
            <td>${row.department}</td>
            <td>${formatScore(row.average_score)}</td>
            <td>${formatSigma(row.sigma_diff)}</td>
            <td>${row.survey_total ? formatNumber(row.survey_total, { maximumFractionDigits: 0 }) : '‚Äî'}</td>
          `;
          bottomBody.appendChild(tr);
        });
      }

      function renderVolatility(insights) {
        const container = document.getElementById('volatility-chart');
        const summary = document.getElementById('volatility-summary');
        if (!window.Plotly) {
          container.textContent = '‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Plotly ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏î‡∏±‡∏ä‡∏ô‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô';
          return;
        }
        const unstable = insights.volatility.most_unstable.slice(0, 10);
        const trace = {
          type: 'bar',
          orientation: 'h',
          x: unstable.map((item) => item.volatility_index),
          y: unstable.map((item) => item.department),
          marker: {
            color: '#f59e0b'
          },
          hovertemplate:
            '<b>%{y}</b><br>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô œÉ: %{x}<br>‡∏ä‡πà‡∏ß‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: %{customdata[0]}<br>‡πÅ‡∏ô‡∏ß‡πÇ‡∏ô‡πâ‡∏°/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: %{customdata[1]}<br>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï: %{customdata[2]}<extra></extra>',
          customdata: unstable.map((item) => [formatScore(item.score_range), formatScore(item.trend_per_month), item.observations])
        };
        const layout = {
          height: 45 * unstable.length + 80,
          margin: { l: 180, r: 30, t: 10, b: 30 },
          paper_bgcolor: 'rgba(15,23,42,0)',
          plot_bgcolor: 'rgba(15,23,42,0)',
          xaxis: {
            title: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô (œÉ)',
            color: '#94a3b8',
            gridcolor: 'rgba(148, 163, 184, 0.25)'
          },
          yaxis: {
            color: '#e2e8f0'
          }
        };
        Plotly.newPlot(container, [trace], layout, { responsive: true, displayModeBar: false });

        summary.innerHTML = '';
        const median = insights.volatility.summary.median_volatility;
        const unstableNames = unstable.slice(0, 3).map((item) => item.department).join(', ');
        const stableNames = insights.volatility.most_stable.slice(0, 3).map((item) => item.department).join(', ');
        const items = [
          `‡∏Ñ‡πà‡∏≤ œÉ ‡∏°‡∏±‡∏ò‡∏¢‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á ${insights.volatility.summary.departments_evaluated} ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô: <span class="highlight-value">${formatScore(
            median
          )}</span>`,
          `‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: <span class="highlight-value">${unstableNames}</span>`,
          `‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: <span class="highlight-value">${stableNames}</span>`
        ];
        for (const text of items) {
          const span = document.createElement('span');
          span.innerHTML = text;
          summary.appendChild(span);
        }
      }

      function renderPerformanceLists(insights) {
        const highList = document.getElementById('high-performance-list');
        const gapList = document.getElementById('critical-gaps-list');
        highList.innerHTML = '';
        gapList.innerHTML = '';

        const makeItem = (record, highlightVolatility = false) => {
          const li = document.createElement('li');
          const title = document.createElement('strong');
          title.textContent = record.department;
          const details = document.createElement('span');
          const parts = [
            `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${formatScore(record.average_score)}`,
            `<span class="list-detail-accent">‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à ${formatNumber(record.survey_total, { maximumFractionDigits: 0 })}</span>`,
            `<span class="list-detail-accent">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${record.months_observed}</span>`
          ];
          if (highlightVolatility && record.volatility_index != null) {
            parts.push(`œÉ ${formatScore(record.volatility_index)}`);
          }
          details.innerHTML = parts.join(' ¬∑ ');
          li.appendChild(title);
          li.appendChild(details);
          return li;
        };

        insights.high_performance.forEach((record) => {
          highList.appendChild(makeItem(record, true));
        });

        insights.critical_gaps.forEach((record) => {
          const li = document.createElement('li');
          const title = document.createElement('strong');
          title.textContent = record.department;
          const details = document.createElement('span');
          const parts = [
            `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${formatScore(record.average_score)}`,
            `<span class="list-detail-accent">‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à ${formatNumber(record.survey_total, { maximumFractionDigits: 0 })}</span>`,
            `<span class="list-detail-accent">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ${record.months_observed}</span>`
          ];
          if (record.volatility_index != null) {
            parts.push(`œÉ ${formatScore(record.volatility_index)}`);
          }
          details.innerHTML = parts.join(' ¬∑ ');
          li.appendChild(title);
          li.appendChild(details);
          gapList.appendChild(li);
        });
      }

      function renderTrendExplorer(insights) {
        const select = document.getElementById('trend-select');
        const chart = document.getElementById('trend-chart');
        const stats = document.getElementById('trend-stats');
        const monthsPill = document.getElementById('trend-months');
        const departments = insights.trends.departments;
        const map = new Map(departments.map((item) => [item.department, item]));

        const defaultDepartment = departments
          .slice()
          .sort((a, b) => (b.mean_score - a.mean_score !== 0 ? b.mean_score - a.mean_score : b.months_observed - a.months_observed))[0]
          .department;

        select.innerHTML = '';
        for (const item of departments) {
          const option = document.createElement('option');
          option.value = item.department;
          option.textContent = item.department;
          if (item.department === defaultDepartment) {
            option.selected = true;
          }
          select.appendChild(option);
        }

        const render = (department) => {
          const entry = map.get(department);
          if (!entry || !window.Plotly) return;
          const x = entry.series.map((point) => point.period);
          const y = entry.series.map((point) => point.average_score);
          const text = entry.series.map(
            (point) => `${formatPeriod(point.period)}<br>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ${formatScore(point.average_score)}<br>‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à ${point.survey_count ?? '‚Äî'}`
          );
          const trace = {
            x,
            y,
            text,
            type: 'scatter',
            mode: 'lines+markers',
            line: { color: '#38bdf8', width: 3 },
            marker: { color: '#0ea5e9', size: 8 },
            hovertemplate: '%{text}<extra></extra>'
          };
          const layout = {
            margin: { t: 10, r: 20, l: 50, b: 60 },
            yaxis: {
              title: '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢',
              range: [3, 5],
              color: '#94a3b8',
              gridcolor: 'rgba(148, 163, 184, 0.25)'
            },
            xaxis: {
              title: '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
              color: '#94a3b8'
            },
            paper_bgcolor: 'rgba(15,23,42,0)',
            plot_bgcolor: 'rgba(15,23,42,0)'
          };
          Plotly.newPlot(chart, [trace], layout, { responsive: true, displayModeBar: false });

          monthsPill.textContent = `‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏° ${entry.months_observed} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
          stats.innerHTML = '';
          const bestPoint = entry.series.reduce((acc, point) => (point.average_score > acc.average_score ? point : acc), entry.series[0]);
          const worstPoint = entry.series.reduce((acc, point) => (point.average_score < acc.average_score ? point : acc), entry.series[0]);
          const statItems = [
            `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ <span class="highlight-value">${formatScore(entry.mean_score)}</span>`,
            `‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î <span class="highlight-value">${formatPeriod(bestPoint.period)}</span> (${formatScore(bestPoint.average_score)})`,
            `‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î <span class="highlight-value">${formatPeriod(worstPoint.period)}</span> (${formatScore(worstPoint.average_score)})`
          ];
          for (const textItem of statItems) {
            const span = document.createElement('span');
            span.innerHTML = textItem;
            stats.appendChild(span);
          }
        };

        select.addEventListener('change', () => render(select.value));
        render(defaultDepartment);
      }

      function renderThemes(insights) {
        const container = document.getElementById('theme-chart');
        const legend = document.getElementById('theme-legend');
        if (!window.Plotly) {
          container.textContent = '‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Plotly ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏ó‡∏°‡πå‡πÑ‡∏•‡∏ô‡πå‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠';
          return;
        }
        const periods = insights.themes_over_time.map((row) => row.period);
        const traces = Object.keys(themeLabels).map((key, index) => ({
          x: periods,
          y: insights.themes_over_time.map((row) => row.themes[key] || 0),
          type: 'bar',
          name: themeLabels[key],
          marker: { color: themePalette[index % themePalette.length] }
        }));
        const layout = {
          barmode: 'stack',
          margin: { t: 10, r: 20, l: 50, b: 60 },
          paper_bgcolor: 'rgba(15,23,42,0)',
          plot_bgcolor: 'rgba(15,23,42,0)',
          yaxis: {
            title: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á',
            color: '#94a3b8',
            gridcolor: 'rgba(148, 163, 184, 0.25)'
          },
          xaxis: {
            title: '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô',
            color: '#94a3b8'
          }
        };
        Plotly.newPlot(container, traces, layout, { responsive: true, displayModeBar: false });

        legend.innerHTML = '';
        Object.entries(themeLabels).forEach(([key, label], index) => {
          const span = document.createElement('span');
          const color = themePalette[index % themePalette.length];
          span.innerHTML = `<span style="width:12px;height:12px;border-radius:3px;background:${color};display:inline-block;"></span>${label}`;
          span.style.color = 'rgba(30, 41, 59, 0.85)';
          span.style.fontWeight = '600';
          span.style.display = 'inline-flex';
          span.style.alignItems = 'center';
          span.style.gap = '0.35rem';
          legend.appendChild(span);
        });

        const topThemes = Object.entries(insights.systemic_themes.themes)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 3)
          .map(([key, count]) => ({
            label: themeLabels[key] || key,
            count
          }));
        const systemicList = document.getElementById('systemic-weaknesses');
        systemicList.innerHTML = '';
        topThemes.forEach((item) => {
          const li = document.createElement('li');
          li.innerHTML = `<strong>${item.label}</strong> ‚Äî ${formatNumber(item.count)} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
          systemicList.appendChild(li);
        });

        const sentimentTotals = insights.systemic_themes.sentiment_totals;
        const total = Object.values(sentimentTotals).reduce((acc, value) => acc + value, 0);
        const positiveShare = total ? (sentimentTotals.positive || 0) / total : 0;
        const negativeShare = total ? (sentimentTotals.negative || 0) / total : 0;
        const summary = document.getElementById('sentiment-summary');
        summary.innerHTML = `‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô <span class="highlight-value">${formatPercent(
          positiveShare
        )}</span> ‡∏Ç‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏Ç‡πâ‡∏≠‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ñ‡∏¥‡∏î‡πÄ‡∏õ‡πá‡∏ô <span class="highlight-value">${formatPercent(negativeShare)}</span> ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${formatNumber(
          total
        )} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;

        const timeBody = document.getElementById('time-table');
        timeBody.innerHTML = '';
        insights.systemic_themes.time_of_day.forEach((row) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${timeLabels[row.time] || row.time}</td>
            <td>${formatNumber(row.mentions)}</td>
            <td>${formatPercent(row.share)}</td>
          `;
          timeBody.appendChild(tr);
        });

        const demographicBody = document.getElementById('demographic-mentions');
        demographicBody.innerHTML = '';
        insights.systemic_themes.demographic_mentions.forEach((row) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${demographicLabels[row.group] || row.group}</td>
            <td>${formatNumber(row.mentions)}</td>
          `;
          demographicBody.appendChild(tr);
        });
      }

      function renderWaitCorrelation(insights) {
        const container = document.getElementById('wait-correlation-chart');
        const note = document.getElementById('wait-correlation-note');
        if (!window.Plotly) {
          container.textContent = '‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Plotly ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå';
          return;
        }
        const series = insights.wait_time_correlation.series;
        const trace = {
          x: series.map((row) => row.wait_share * 100),
          y: series.map((row) => row.satisfaction),
          mode: 'markers+text',
          text: series.map((row) => row.period),
          textposition: 'top center',
          marker: {
            color: '#38bdf8',
            size: 10
          },
          hovertemplate: '‡πÄ‡∏î‡∏∑‡∏≠‡∏ô %{text}<br>‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢ %{customdata[0]} / %{customdata[1]}<br>‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á %{x:.1f}%<br>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ %{y:.3f}<extra></extra>',
          customdata: series.map((row) => [row.wait_mentions, row.comment_total])
        };
        const layout = {
          margin: { t: 10, r: 20, l: 60, b: 60 },
          xaxis: {
            title: '‡∏Å‡∏≤‡∏£‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢ (% ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏´‡πá‡∏ô)',
            color: '#94a3b8',
            gridcolor: 'rgba(148, 163, 184, 0.25)'
          },
          yaxis: {
            title: '‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢',
            color: '#94a3b8',
            range: [3.5, 5]
          },
          paper_bgcolor: 'rgba(15,23,42,0)',
          plot_bgcolor: 'rgba(15,23,42,0)'
        };
        Plotly.newPlot(container, [trace], layout, { responsive: true, displayModeBar: false });

        const r = insights.wait_time_correlation.pearson_r;
        const p = insights.wait_time_correlation.p_value;
        note.innerHTML = `‡∏Ñ‡πà‡∏≤‡∏™‡∏´‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå r = <span class="highlight-value">${r !== null ? r.toFixed(2) : '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</span>, p-value = <span class="highlight-value">${
          p !== null ? p.toFixed(2) : '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'
        }</span> ‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏û‡∏∂‡∏á‡∏û‡∏≠‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏•‡∏î‡∏•‡∏á‡πÉ‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô`;
      }

      function renderBenchmarking(insights) {
        const list = document.getElementById('benchmarking-list');
        list.innerHTML = '';
        const topStats = insights.benchmarking.top10.stats;
        const bottomStats = insights.benchmarking.bottom10.stats;
        const delta = insights.benchmarking.delta;
        const items = [
          `‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° 10 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏Å <span class="highlight-value">${formatScore(topStats.mean_score)}</span> ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î <span class="highlight-value">${formatScore(
            bottomStats.mean_score
          )}</span> (‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á ${formatScore(delta.score_gap)})`,
          `‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏£‡∏≤‡∏ß <span class="highlight-value">${formatNumber(Math.round(topStats.mean_survey_total))}</span> ‡∏â‡∏ö‡∏±‡∏ö‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö <span class="highlight-value">${formatNumber(
            Math.round(bottomStats.mean_survey_total)
          )}</span> ‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡πà‡∏≤‡∏á`,
          `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏±‡∏ô‡∏ú‡∏ß‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà ${topStats.mean_volatility != null ? formatScore(topStats.mean_volatility) : '‚Äî'} ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö ${
            bottomStats.mean_volatility != null ? formatScore(bottomStats.mean_volatility) : '‚Äî'
          } ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏•‡πà‡∏≤‡∏á`
        ];
        items.forEach((text) => {
          const li = document.createElement('li');
          li.innerHTML = text;
          list.appendChild(li);
        });
      }

      function renderPredictiveRisk(insights) {
        const tbody = document.querySelector('#risk-table tbody');
        tbody.innerHTML = '';
        const nextPeriod = insights.predictive_risk.next_period;
        if (nextPeriod) {
          document.querySelector('#predictive-risk h2').innerHTML = `‡∏°‡∏∏‡∏°‡∏°‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏Ñ‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ì‡πå <span class="pill">‡∏ä‡πà‡∏ß‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ${nextPeriod}</span>`;
        }
        insights.predictive_risk.high_risk_departments.slice(0, 15).forEach((row) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${row.department}</td>
            <td>${formatPercent(row.probability_of_decline)}</td>
            <td>${row.last_period}</td>
            <td>${formatScore(row.last_score)}</td>
          `;
          tbody.appendChild(tr);
        });
      }

      function renderDemographicTables(insights) {
        const serviceBody = document.querySelector('#service-group-table tbody');
        serviceBody.innerHTML = '';
        insights.demographic_disparity.service_groups.forEach((row) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${row.service_group}</td>
            <td>${formatScore(row.average_score)}</td>
            <td>${formatNumber(row.survey_total)}</td>
            <td>${formatNumber(row.departments)}</td>
          `;
          serviceBody.appendChild(tr);
        });

        const demoBody = document.querySelector('#demographic-table tbody');
        demoBody.innerHTML = '';
        insights.demographic_disparity.comment_mentions.forEach((row) => {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${demographicLabels[row.group] || row.group}</td>
            <td>${formatNumber(row.mentions)}</td>
          `;
          demoBody.appendChild(tr);
        });
      }

      async function init() {
        const [summaryResponse, insightsResponse] = await Promise.all([
          fetch('data/summary.json'),
          fetch('data/advanced_insights.json')
        ]);
        const summary = await summaryResponse.json();
        const insights = await insightsResponse.json();

        renderMetrics(summary.metadata);
        renderMonthlyTable(summary);
        renderRanking('overall', summary);

        const buttons = document.querySelectorAll('.tab-strip button');
        buttons.forEach((button) => {
          button.addEventListener('click', () => {
            buttons.forEach((btn) => btn.classList.toggle('active', btn === button));
            renderRanking(button.dataset.key, summary);
          });
        });

        renderVolatility(insights);
        renderPerformanceLists(insights);
        renderTrendExplorer(insights);
        renderThemes(insights);
        renderWaitCorrelation(insights);
        renderBenchmarking(insights);
        renderPredictiveRisk(insights);
        renderDemographicTables(insights);
      }

      init().catch((error) => {
        console.error('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', error);
      });
    </script>
  </body>
</html>
